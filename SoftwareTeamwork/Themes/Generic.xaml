<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:SoftwareTeamwork">

    <!--Commands-->
    <local:ClsCommand x:Key="ClsCommand"/>
    
    <!--Converters-->
    <local:StrToPathConverter x:Key="StrToPathConverter"/>
    <local:ColortoBrushConverter x:Key="ColortoBrushConverter"/>
    <local:DubtoGridlConverter x:Key="DubtoGridlConverter"/>

    <!--Styles-->
    <Style TargetType="{x:Type local:DContextMenu}">
        <Setter Property="Padding" Value="-1"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:DContextMenu}">
                    <Border x:Name="RootBorder" BorderThickness="2" BorderBrush="{TemplateBinding BorderBrush}">
                        <Grid x:Name="RootGrid" Margin="{TemplateBinding Padding}" Background="{TemplateBinding Background}">
                            <ItemsPresenter x:Name="ItemsPresenter" KeyboardNavigation.DirectionalNavigation="Cycle"/>
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type local:DMenuItem}">
        <Setter Property="FontWeight" Value="Light"/>
        <Setter Property="Background" Value="{StaticResource VsBorderBrush}"/>
        <Setter Property="Foreground" Value="{StaticResource NotifyTextColor_L1_N}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:DMenuItem}">
                    <Grid x:Name="RootGrid" Height="{StaticResource NotifyContextmenuItemHeight}" Margin="0,0,2,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="{Binding Source={StaticResource NotifyContextmenuItemHeight},Converter={StaticResource DubtoGridlConverter}}"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Rectangle x:Name="RootBorder" Fill="White" Opacity="0" Margin="2"/>
                        <TextBlock x:Name="Icon" FontFamily="Segoe MDL2 Assets" 
                                   FontSize="{TemplateBinding FontSize}"
                                   Foreground="{TemplateBinding Foreground}"
                                   Text="{TemplateBinding Icon}"
                                   TextAlignment="Center" 
                                   HorizontalAlignment="Center" 
                                   VerticalAlignment="Center" />
                        <TextBlock x:Name="Text" Grid.Column="1" Width="100" Margin="10,0,0,0"
                                   Foreground="{TemplateBinding Foreground}"
                                   FontSize="{StaticResource NotifyContextmenuTextSize}"
                                   Text="{TemplateBinding Header}"
                                   VerticalAlignment="Center" />
                        <Rectangle x:Name="TextBLockUnderLine" Height="1" Grid.Column="1" Fill="White" VerticalAlignment="Bottom" Margin="0,0,0,2"
                                   Opacity="0"/>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter TargetName="RootBorder" Property="Opacity" Value="1"/>
                            <Setter TargetName="Icon" Property="Foreground" Value="Black"/>
                            <Setter TargetName="TextBLockUnderLine" Property="Opacity" Value="1"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <Style TargetType="{x:Type local:AIWindow}">
        <Setter Property="WindowStyle" Value="None"/>
        <Setter Property="AllowsTransparency" Value="True"/>
        <Setter Property="Background" Value="#FF1E1E1E"/>
        <Setter Property="Width" Value="248"/>
        <Setter Property="Height" Value="400"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:AIWindow}">
                    <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}">
                        <AdornerDecorator>
                            <ContentPresenter/>
                        </AdornerDecorator>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--Controls-->
    
    <local:DContextMenu x:Key="DcontextMenu" Background="{StaticResource VsBackGroundBrush}"
                 Placement="MousePoint" >
        <local:DContextMenu.Effect>
            <DropShadowEffect Color="{StaticResource VsBorderColor}" BlurRadius="5" ShadowDepth="0"/>
        </local:DContextMenu.Effect>
        <local:DMenuItem x:Name="M1" Icon="&#xE15E;" Header="打开主界面" />
        <local:DMenuItem x:Name="M2" Icon="&#xEA39;" Header="退出程序" Command="{StaticResource ClsCommand}" CommandParameter="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=local:AIWindow}}"/>
    </local:DContextMenu>

    
    <local:DPopup x:Key="DPopup" AllowsTransparency="True" ThemeBg="{StaticResource VsBackGroundColor}" ThemeBorderC="{StaticResource VsBorderColor}">
        <Border x:Name="ContentPanel" Width="300" Height="80" BorderThickness="1" Margin="3">
            <Border.BorderBrush>
                <SolidColorBrush Color="{Binding ThemeBorderC, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=local:DPopup}}"/>
            </Border.BorderBrush>
            <Border.Effect>
                <DropShadowEffect Color="{Binding ThemeBorderC, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=local:DPopup}}" 
                                  Opacity="{Binding Shadow, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=local:DPopup}}"
                                  BlurRadius="5" ShadowDepth="0" />
            </Border.Effect>
            <Grid>
                <Grid.Background>
                    <SolidColorBrush Color="{Binding ThemeBg, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=local:DPopup}}"/>
                </Grid.Background>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="auto"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <TextBlock x:Name="Title" Text="{Binding Title,RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=local:DPopup}}" FontSize="14" Foreground="{StaticResource NotifyTextColor_L1_N}" FontWeight="UltraLight"  VerticalAlignment="Center" Grid.Column="1" />
                <TextBlock x:Name="Content" Text="{Binding Content,RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=local:DPopup}}" FontSize="12" Foreground="{StaticResource NotifyTextColor_L2_N}" FontWeight="Thin" 
                              VerticalAlignment="Center" Grid.Column="1" Grid.Row="1" />
                <Canvas Width="60" Height="60" HorizontalAlignment="Center" VerticalAlignment="Center" Grid.RowSpan="2" >
                    <Path Data="{Binding IconPath, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=local:DPopup},Converter={StaticResource StrToPathConverter}}" Stroke="{StaticResource NotifyTextColor_L1_N}" StrokeThickness="5">
                    </Path>
                </Canvas>
            </Grid>
        </Border>
    </local:DPopup>
</ResourceDictionary>
